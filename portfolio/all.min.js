"use strict";function _toConsumableArray(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}var portfolio=angular.module("portfolio",["ngAnimate","ngSanitize","mobile-angular-ui","mobile-angular-ui.gestures.drag","mobile-angular-ui.gestures.touch","ngAnimate","ngSanitize"]).filter("byCategories",function(){return function(e,t){return void 0===t||0==t.length?e:e.filter(function(e){if(e.categories.some(function(e){return t.indexOf(e)>-1}))return e})}}).filter("byExperience",function(){return function(e,t,n){return e.filter(function(e){if(t||(t=0),n||(n=99),e.experience>=t&&e.experience<=n)return e})}}).filter("lowerCaseAndReplaceSpaces",function(){return function(e){return e.replace(/\s+/g,"-").toLowerCase()}});portfolio.factory("landingService",["$q",function(e){var t=e.defer(),n=e.defer(),r=e.defer(),o=([n.promise,r.promise],e.defer(),e.defer()),i=e.defer(),a=e.defer();return{renderedBox:function(){return t.resolve()},canShowBox:function(){return t.promise},animatedB:function(){return n.resolve()},canAnimateExplosion:function(){return n.promise},animatedExplosion:function(){return o.resolve()},canAnimateCard:function(){return o.promise},animatedCard:function(){return i.resolve()},canAnimateControls:function(){return i.promise},loadedProjects:function(){return a.resolve()},canBindProjectsCardsTransform:function(){return a.promise}}}]),portfolio.factory("projectsService",["$q","$http","$rootScope","landingService","$timeout",function(e,t,n,r,o){r.canAnimateCard().then(function(){o(function(){t.get("resources/json/projects.json").then(function(e){n.projects=e.data,r.loadedProjects()})},888)});var i=0,a=null;return{cardCount:function(){return i},activeCard:function(){return a},addCard:function(){var e=i++;return a=1===i?e:a,e},next:function(){a=a||0,a=a===i-1?0:a+1},prev:function(){a=a||0,a=0===a?i-1:a-1},cardSpreadInterval:function s(){var s=.05*document.querySelector(".cards-inner").clientHeight/(i-1);if(i>0)return s}}}]),portfolio.factory("skillzService",["$http","$rootScope","landingService","$timeout","$q",function(e,t,n,r){return t.dummySkillzCategoriesList=[],e.get("resources/json/skillz.json").then(function(e){var n;t.skillz=e.data;for(var r=e.data.length-1;r>=0;r--)t.dummySkillzCategoriesList.push(e.data[r].categories);t.dummySkillzCategoriesList=[].concat(_toConsumableArray(new Set((n=[]).concat.apply(n,_toConsumableArray(t.dummySkillzCategoriesList)))))}),{dummySkillzCategoriesList:function(){}}}]),portfolio.controller("BoxController",["$scope","landingService",function(e,t){var n=this;e.shown="front",t.canAnimateCard().then(function(){document.querySelector(".front.shown").classList+=" bg-dark"});var r=Math.max(document.documentElement.clientWidth,window.innerWidth||0)-4,o=Math.max(document.documentElement.clientHeight,window.innerHeight||0)-4,i=document.getElementById("box-container").style;i.width=r+"px",i.height=o+"px";var a=r/2+"px",s=document.getElementById("box");s.style.transform="translateZ(-"+a+") rotateY(0deg)";var l=["front","right","back","left"];this.sides=l;for(var c=l.length-1;c>=0;c--){var d;switch(l[c]){case"front":d="0deg";break;case"right":d="90deg";break;case"back":d="180deg";break;case"left":d="-90deg"}var u=document.querySelector("#box ."+l[c]);u.style.transform="rotateY("+d+") translateZ("+a+")",u.style.width=r+"px",u.style.height=o+"px"}t.renderedBox(),n.showSide=function(t){document.querySelector("#side-controls a:last-child").style.animationName="none",document.getElementById("networkmap-modal").classList.remove("modal-rendered");var n=document.querySelector("#side-controls a:first-child"),r=document.querySelector("#side-controls a:last-child");n.style.opacity="1",r.style.opacity="1";var o;switch(t){case"front":n.style.opacity=0,o="0deg";break;case"right":o="-90deg";break;case"back":o="-180deg",document.getElementById("networkmap-modal").classList.add("modal-rendered");break;case"left":r.style.opacity=0,o="-270deg"}e.shown=t,s.style.transform="translateZ(-"+a+") rotateY("+o+")"}}]),portfolio.controller("PortfolioController",["$scope","$http","$window","$timeout","projectsService","landingService","skillzService","$location","$anchorScroll","$document","$rootScope",function(e,t,n,r,o,i,a,s,l,c,d){e.showLandingContent=!1,e.scrollable="unscrollable",this.scrollableToggle=function(t){e.scrollable=t?"scrollable":"unscrollable"},this.closeActionMenu=function(){e.actionMenuOpened=!1,document.querySelector("#action-button input").checked=!1,document.getElementById("box-container").classList.remove("open-menu-blur"),document.querySelector("#side-controls a:first-child").style.left=0,document.querySelector("#side-controls a:last-child").style.right=0},e.actionMenuOpened=!1,e.skillzOrderProperty="skill",e.skillzOrderReverse=!1,e.skillzFilterCategories=[],e.toggleCategoryFilter=function(t){e.skillzFilterCategories.indexOf(t)>-1?e.skillzFilterCategories.splice(e.skillzFilterCategories.indexOf(t),1):e.skillzFilterCategories.push(t)},e.skillzFilterExperienceMin=0,e.skillzFilterExperienceMax=99}]),portfolio.directive("actionMenuButton",["$timeout",function(e){return{controller:"PortfolioController",link:function(t,n,r,o){var i=document.getElementById("box-container");n.bind("click",function(){e(function(){o.actionMenuOpened=!!n[0].querySelector("input").checked,o.actionMenuOpened?(i.classList.contains("open-menu-blur")||(i.classList.add("open-menu-blur"),n[0].classList.add("open")),document.querySelector("#side-controls a:first-child").style.left="-88vw",document.querySelector("#side-controls a:last-child").style.right="-88vw"):o.actionMenuOpened||(i.classList.contains("open-menu-blur")&&(i.classList.remove("open-menu-blur"),n[0].classList.remove("open")),document.querySelector("#side-controls a:first-child").style.left=0,document.querySelector("#side-controls a:last-child").style.right=0)})})}}}]),portfolio.directive("actionMenuItemButton",["$timeout",function(e){return{link:function(t,n,r){n.bind("click",function(){e(function(){t.actionMenuOpened=!1})})}}}]),portfolio.directive("animejsBanner",["$q","landingService",function(e,t){return{restrict:"AE",templateUrl:"js/directives/animejs-banner/animejs-banner.html",controller:"PortfolioController",transclude:!0,link:function(e,n,r,o){n[0].querySelector("#loading-squares");t.canShowBox().then(function(){document.getElementById("box-container").className+="show-box",anime({targets:"#Bsvg path",strokeDashoffset:{easing:"easeInExpo",duration:500,value:function(e){var t=e.getTotalLength();return e.setAttribute("stroke-dasharray",t),[-t,0]}},stroke:{value:function(e,t){return"rgb("+2*t+","+8*t+","+12*t+")"},easing:"linear",duration:222},strokeWidth:{value:8,easing:"linear",delay:function(e,t){return 222+22*t},duration:222},opacity:{value:[0,1],duration:250,delay:250,easing:"linear"},delay:function(e,t){return 30*t},duration:1200,easing:"easeOutExpo",loop:!1,direction:"alternate",update:function(e){},complete:function(){t.animatedB()}})}),t.animatedB()}}}]),portfolio.directive("animejsExplosion",["$q","landingService","$timeout",function(e,t,n){return{restrict:"AE",template:'<canvas id="animejs-explosion"></canvas>',controller:"PortfolioController",link:function(e,r,o,i){t.canAnimateExplosion().then(function(){n(function(){function e(e){o();var n=h.indexOf(e);n>-1&&h.splice(n,1),t.animatedExplosion()}function n(e,t){var n=Math.max(e-0,u-e),r=Math.max(t-0,d-t);return Math.sqrt(Math.pow(n,2)+Math.pow(r,2))}function r(){document.addEventListener("touchstart",i),document.addEventListener("mousedown",i)}function o(){document.removeEventListener("touchstart",i),document.removeEventListener("mousedown",i)}function i(t){t.touches&&(t.preventDefault(),t=t.touches[0]);for(var r="#3cf0ff",o=n(t.pageX,t.pageY),i=Math.min(200,.4*u),a=750,s=new g({x:t.pageX,y:t.pageY,r:0,fill:"#18212D"}),l=anime({targets:s,r:o,duration:Math.max(o/2,a),easing:"easeOutQuart",complete:function(){f=s.fill,e(l)}}),c=new g({x:t.pageX,y:t.pageY,r:0,fill:"#3cf0ff",stroke:{width:3,color:"#3cf0ff"},opacity:1}),d=anime({targets:c,r:i,opacity:0,easing:"easeOutExpo",duration:900,complete:e}),m=[],p=0;p<32;p++){var v=new g({x:t.pageX,y:t.pageY,fill:r,r:anime.random(24,48)});m.push(v)}var y=anime({targets:m,x:function(e){return e.x+anime.random(i,-i)},y:function(e){return e.y+anime.random(1.15*i,1.15*-i)},r:0,easing:"easeOutExpo",duration:anime.random(1e3,1300),complete:e});h.push(l,d,y)}function a(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);return e}function s(){function e(){clearTimeout(t),document.removeEventListener("mousedown",e),document.removeEventListener("touchstart",e)}var t=setTimeout(function(){c(u/2,d/2)},0);document.addEventListener("mousedown",e),document.addEventListener("touchstart",e)}function l(){setTimeout(function(){c(anime.random(.2*u,.8*u),anime.random(.2*d,.8*d)),l()},anime.random(200,900))}function c(e,t){var n=new Event("mousedown");n.pageX=e,n.pageY=t,document.dispatchEvent(n)}var d,u,m=document.getElementById("animejs-explosion"),p=m.getContext("2d"),f="transparent",h=[],g=function(e){a(this,e)};g.prototype.draw=function(){p.globalAlpha=this.opacity||1,p.beginPath(),p.arc(this.x,this.y,this.r,0,2*Math.PI,!1),this.stroke&&(p.strokeStyle=this.stroke.color,p.lineWidth=this.stroke.width,p.stroke()),this.fill&&(p.fillStyle=this.fill,p.fill()),p.closePath(),p.globalAlpha=1};var v=(anime({duration:3825,update:function(e){p.fillStyle=f,p.fillRect(0,0,u,d),h.forEach(function(e){e.animatables.forEach(function(e){e.target.draw()})})}}),function(){u=window.innerWidth,d=window.innerHeight,m.width=u*devicePixelRatio,m.height=d*devicePixelRatio,p.scale(devicePixelRatio,devicePixelRatio)});!function(){v(),window.CP&&(window.CP.PenTimer.MAX_TIME_IN_LOOP_WO_EXIT=6e3),window.addEventListener("resize",v),r(),window.location.pathname.match(/fullcpgrid/)&&l(),s()}()},0)})}}}]),portfolio.directive("bubbleGradient",[function(){return{restrict:"AE",link:function(e,t,n,r){var o=$('<canvas id="bubble-gradient" width="'+t.width()+'" height="'+t.height()+'"></canvas>').css({"z-index":0,position:"absolute"});t.append(o),console.log(e,t,this);var i=document.querySelector("#bubble-gradient"),a=i.getContext("2d"),s=i.width,l=i.height;a.clearRect(0,0,s,l),a.fillStyle="#EEEEEE",a.fillRect(0,0,s,l);var c=function(e,t,n){this.x=e,this.y=t,this.radius=0,this.angle=0,this.full=n};c.prototype.grow=function(){return a.beginPath(),this.radius=this.full*Math.abs(Math.sin(this.angle)),a.arc(s-this.x,this.y,this.radius,0,2*Math.PI,!1),a.closePath(),a.fillStyle="#006699",a.fill(),this.angle+=.01,!(this.radius<this.full)};var d,u,m,p,f,h,g;d=u=m=p=0,f=10,h=l/5,g=l/5;var v=setInterval(function(){var e=new c(d,u,s/5),t=setInterval(function(){e.grow()&&clearInterval(t)},1);d>=s&&u>=l?(console.log("stopping"),clearInterval(v)):d<=0||u>=l?(m<s?(h-=5,m+=h):p+=g,u=p,d=m):(d-=h,u+=g)},f)}}}]),portfolio.directive("landingContent",["$timeout","landingService",function(e,t){return t.animatedCard(),{restrict:"AE",templateUrl:"js/directives/landing-content/landing-content.html",scope:!1,link:function(n,r,o,i){var a=r[0].querySelector("h1"),s=r[0].querySelector("p");t.canAnimateCard().then(function(){a.style.display="block",e(function(){n.showLandingContent=!0,angular.element(document.getElementById("action-button")).toggleClass("show-action-button")});var r=!1;anime({targets:a,delay:222,translateY:{value:["4.2em","0em"],duration:1888,direction:"normal",delay:2e3},fontSize:{value:["2em","1.2em"],duration:1888,direction:"normal",delay:2e3},update:function(e){0==r&&e.progress>50&&(r=!0,s.style.display="block",anime({targets:s,delay:222,opacity:{value:[0,1],duration:888},complete:function(){t.animatedCard()}}))}}),t.canAnimateControls().then(function(){e(function(){document.getElementById("side-controls").style.opacity=1,document.querySelector("#side-controls a:last-child").style.transform="scale(1)",document.querySelector("#side-controls a:last-child").style.animation="pulse .8s infinite alternate"},888)})})}}}]),portfolio.directive("card",["$drag","$touch","projectsService","landingService","$timeout",function(e,t,n,r,o){return{restrict:"C",transclude:!0,template:'<div class="project"><div ng-transclude></div></div>',controller:"PortfolioController",link:function(i,a,s,l){function c(){return!!a[0].querySelector(".flip-card").classList.contains("flipped")}var d,u,m,p;d=u=n.addCard(),p=0,m=a[0].style.zIndex,i.$watch(function(){return n.activeCard()},function(){p=0,p=d===n.activeCard()?0:n.activeCard()<d?d-n.activeCard():n.cardCount()-1-n.activeCard()+d,a[0].style.zIndex=2e3-p,u<0&&(u=n.cardCount()-1),u--,a[0].style.width=100-(u+1)+"%",a[0].style.top=n.cardSpreadInterval()*(u+1)+"px"}),r.canBindProjectsCardsTransform().then(function(){e.bind(a,{transform:function(t,n,r){if(c()){var o=t[0].querySelector(".card-back > ng-include");return o.scrollTop+=-r.stepY,e.NULL_TRANSFORM(t,n,r)}var i=e.TRANSLATE_BOTH(t,n,r),a=r.distanceX,s=r.startTransform,l=a<0?-1:1,d=l*Math.min(Math.abs(a)/700*30,30);return i.rotateZ=d+Math.round(s.rotateZ),i},start:function(e,t){t.stopPropagation(),l.scrollableToggle(!1)},move:function(e,t){c()||(t.stopPropagation(),a[0].style.opacity=1-Math.abs(e.distanceX)/e.rect.width,Math.abs(e.distanceX)>=e.rect.width/4?a.addClass("dismiss"):a.removeClass("dismiss"))},cancel:function(){a.removeClass("dismiss")},end:function(e){c()||(a[0].style.opacity=1,l.scrollableToggle(!0),a.removeClass("dismiss"),Math.abs(e.distanceX)>=e.rect.width/4&&i.$apply(function(){n.next()}),e.reset())}}),t.bind(a,{end:function(e,t){if(!c()&&Math.abs(e.total)<a[0].clientWidth/8){var n=a[0].querySelector(".flip-card");n.classList.toggle("flipped"),n.classList.contains("flipped-complete")?n.classList.toggle("flipped-complete"):o(function(){n.classList.toggle("flipped-complete")},1e3)}}})})}}}]),portfolio.directive("skillz",["skillzService","$rootScope",function(e,t){return{controller:"PortfolioController",templateUrl:"js/directives/skillz/killz.html",link:function(e,t,n,r){}}}]),portfolio.directive("networkMap",["$http",function(e){return{restrict:"EA",controller:"PortfolioController",link:function t(n,r,o,i){function a(n,r){$("#networkmap").css({display:"inline-block"}),g=n,r=0,void 0!=m&&(m.selectAll("*").remove(),null!=document.getElementById("networkmapsvg")&&$("#networkmapsvg").remove()),m=d3.select("#networkmap").append("svg").attr("id","networkmapsvg").attr("width","100%").attr("height","100%").attr("background-color","white").call(v).attr("style","cursor:move").on("dblclick.zoom",null),p=m.append("g").attr("id","mapcontainer"),e.get("resources/json/network-map.json").then(function(e){function n(e){$("#rounds-list").empty();for(var t=document.getElementById("rounds-list"),n=0;n<=e;n++){console.log("ere");var r=document.createElement("li"),o=document.createElement("a"),i=document.createTextNode(thiscampaignDates[n]);r.setAttribute("class","round"),r.setAttribute("id","round-"+n),r.appendChild(o),o.appendChild(i),o.setAttribute("href","#"),o.setAttribute("class","round-link"),o.setAttribute("onclick","changeMatchTable('matchDate-"+n.toString()+"'); selectRound("+(e-n)+"); return false;"),t.appendChild(r)}}function o(){for(var e=0;e<a.links.length;e++)a.links[e].value<=r&&s.links.unshift(a.links[e])}var i=JSON.stringify(e.data),a=JSON.parse(i),s={nodes:[],links:[]};if(void 0!=a.error)return $("#maplegendholder").empty(),$("#mapdateholder").empty(),$("#networkmap").empty(),$("#networkmap").append('<span id="mapErrorMessage"><strong>'+a.error+"</strong></span>"),$("#roundsListButton").attr("disabled",""),$("#mapcontrols button").css("color","#666"),void console.log("d3 json call got error: "+a.error);$("#mapErrorMessage").remove(),$("#mapcontrols button").removeAttr("disabled"),$("#mapcontrols button").css("color","#333"),$("#roundsListButton").removeAttr("disabled");var u=Math.max.apply(Math,a.links.map(function(e){return e.value}));if(r=u,$("#roundsListButton").on("click",function(e){n(u)}),$(document).on("click","#rounds-list.dropdown-menu li a",function(){var e=$(this).text();$(this).parents("#selectDrawRound").find("#roundsListButton").html($(this).text()+"<span class='caret'></span>"),$("#matchListButton").html(e+"<span class='caret'></span>")}),o(),void 0!=a.error)$("#networkmap").empty(),$("#networkmap").append("<span><strong>"+a.error+"</strong></span>");else{var g;!function(){var e=function(e,r){function o(e,t){return w[e.index+","+t.index]}function i(){d3.event.defaultPrevented||(d=d3.select(this).node().__data__,0==x?($("#userinfoholder").empty(),$("#userinfoholder").append("<p>"+d.first_name+" "+d.last_name+"</p>"),$("#userinfoholder").append("<p>"+d.email+"</p>"),d.group&&$("#userinfoholder").append("<p>"+d.group+"</p>"),h.style("opacity",function(e){return o(e,d)|o(d,e)?1:.1}),t.style("opacity",function(e){return d.index==e.source.index|d.index==e.target.index?1:.1}),x=1):(h.style("opacity",1),t.style("opacity",1),$("#userinfoholder").empty(),x=0))}$("#matchTable tbody").is(":empty")&&void 0!=a.error?$("#matchTable thead").html("<tr><th>"+a.error+"</th></tr>"):$("#matchTable thead").empty(),$("networkmapsvg").length>0?($("#mapcontrols button").attr("disabled",""),$("#selectMatchRound").attr("disabled",""),$("#matchListButton").attr("disabled","")):($("#mapcontrols button").removeAttr("disabled"),$("#selectMatchRound").removeAttr("disabled"),$("#matchListButton").removeAttr("disabled")),r>=u?($("#next-round").attr("disabled","disabled"),$("#previous-round").removeAttr("disabled")):r<=0?($("#previous-round").attr("disabled","disabled"),$("#next-round").removeAttr("disabled")):($("#next-round").removeAttr("disabled"),$("#previous-round").removeAttr("disabled")),$("#playMap").removeAttr("disabled"),$("#pauseMap").removeAttr("disabled"),$("#selectMatchRound").removeAttr("disabled"),m.selectAll(".links").data(f.links()).remove(),m.selectAll(".nodes").data(f.nodes()).remove();var g,v=.5;g=r>0?v/r:.5;var y,b=-200;y=r>0?b-r*(b/u):-200;var k=200;f.nodes(a.nodes).links(e).linkStrength(function(e){return e.source_response>=1||e.target_response>=1?2*g:.2*g}).gravity(.08).distance(k).linkDistance(function(e){return e.source_response>=1||e.target_response>=1?50:null===e.source_response&&null===e.target_response?100:(e.source_response<=0||e.target_response<=0,100)}).charge(-200).friction(.9).size([l,c]).start(),t=p.data(f.links()).append("g").attr("class","links").selectAll(".link").data(e).enter().append("line").attr("class","link").attr("round",function(e){return e.value}).attr("connectednodes",function(e){return e.source.index+" "+e.target.index}).attr("stroke-width",function(e){return void 0==e.source.index||void 0==e.target.index?0:e.source_response>=1||e.target_response>=1?3:null===e.source_response&&null===e.target_response?1:e.source_response<=0||e.target_response<=0?2:1}).style("stroke",function(e){return e.source_response>=1||e.target_response>=1?"#84b750":null===e.source_response&&null===e.target_response?"ccc":e.source_response<=0||e.target_response<=0?"#e8335d":"#ccc"}),f.on("tick",n),h=p.data(f.nodes()).append("g").attr("class","nodes").selectAll(".node").data(a.nodes).enter().append("g").attr("class","node").attr("userid",function(e){return e.userid}).attr("index",function(e){return e.index}).call(f.drag).on("click",i),h.attr("xlink:href",function(e){return"image"in e?e.image:e.url}).append("circle").attr("r",10).style("fill","#1babab").attr("width",function(e){return"image"in e?32:16}).attr("height",function(e){return"image"in e?32:16}).on("mouseover",function(){d3.select(this).style("fill","#1babab").attr("style","cursor:pointer")}).on("mouseout",function(){d3.select(this).style("fill","#1babab")}).on("dblclick.zoom",null),h.append("text").attr("dx",15).attr("dy",".35em").attr("xlink:href",function(e){return e.image}).text(function(e){return e.first_name+" "+e.last_name.substring(0,1)+"."});for(var x=0,w={},S=0;S<a.nodes.length;S++)w[S+","+S]=1;s.links.forEach(function(e){w[e.source.index+","+e.target.index]=1})},n=function(e){t.attr("x1",function(e){return e.source.x}).attr("y1",function(e){return e.source.y}).attr("x2",function(e){return e.target.x}).attr("y2",function(e){return e.target.y}),h.attr("transform",function(e){return"translate("+e.x+","+e.y+")"})};e(s.links,r),$("input:checkbox[name=map-filter]").change(function(){s.links=[],o(),e(s.links,r)}),g=0}()}})}function s(){p.attr("transform","scale("+d3.event.scale+") translate("+d3.event.translate+")")}var l,c,u,m,p,f,t,h,g,v=d3.behavior.zoom().scaleExtent([.02,5]).on("zoom",s);l=Math.min(document.documentElement.clientWidth-42,800),c=Math.min(document.documentElement.clientHeight-42,800),f=d3.layout.force(),u=f.drag().on("dragstart",function(){d3.event.sourceEvent.stopPropagation()}),a(0,0)}}}]),angular.bootstrap(document.documentElement,["portfolio"]);